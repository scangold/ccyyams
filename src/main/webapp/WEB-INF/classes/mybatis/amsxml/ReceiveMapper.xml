<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ReceiveMapper">
  <resultMap id="BaseResultMap" type="com.fh.entity.amsmodel.Receive">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    <id column="RC_ID" jdbcType="INTEGER" property="rcId" />
    <result column="TRANSFNAME" jdbcType="NVARCHAR" property="transfname" />
    <result column="PRODEPART" jdbcType="NVARCHAR" property="prodepart" />
    <result column="RC_NAME" jdbcType="NVARCHAR" property="rcName" />
    <result column="RC_DEPART" jdbcType="NVARCHAR" property="rcDepart" />
    <result column="RC_TIME" jdbcType="TIMESTAMP" property="rcTime" />
    <result column="RC_PROGRESS" jdbcType="NVARCHAR" property="rcProgress" />
    <result column="CHECKFILE_URL" jdbcType="NVARCHAR" property="checkfileUrl" />
    <result column="RC_STRING" jdbcType="NVARCHAR" property="rcString" />
    <result column="RC_REMARK" jdbcType="NVARCHAR" property="rcRemark" />
    <result column="REGISTER_ID" jdbcType="INTEGER" property="registerId" />
    <result column="PRJ_ID" jdbcType="INTEGER" property="prjId" />
    <result column="CHECKDETAILS" jdbcType="NVARCHAR" property="checkdetails" />
    <result column="USER_ID" jdbcType="CHAR" property="userId" />
    <result column="PHOTOGRAPH" jdbcType="NVARCHAR" property="photograph" />
    <result column="AUTOGRAPH" jdbcType="NVARCHAR" property="autograph" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    RC_ID, TRANSFNAME, PRODEPART, RC_NAME, RC_DEPART, RC_TIME, RC_PROGRESS, CHECKFILE_URL, 
    RC_STRING, RC_REMARK, REGISTER_ID, PRJ_ID, CHECKDETAILS, USER_ID, PHOTOGRAPH, AUTOGRAPH
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from ams_receive
    where RC_ID = #{rcId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    delete from ams_receive
    where RC_ID = #{rcId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.fh.entity.amsmodel.Receive">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    insert into ams_receive (RC_ID, TRANSFNAME, PRODEPART, 
      RC_NAME, RC_DEPART, RC_TIME, 
      RC_PROGRESS, CHECKFILE_URL, RC_STRING, 
      RC_REMARK, REGISTER_ID, PRJ_ID, 
      CHECKDETAILS, USER_ID, PHOTOGRAPH, 
      AUTOGRAPH)
    values (#{rcId,jdbcType=INTEGER}, #{transfname,jdbcType=NVARCHAR}, #{prodepart,jdbcType=NVARCHAR}, 
      #{rcName,jdbcType=NVARCHAR}, #{rcDepart,jdbcType=NVARCHAR}, #{rcTime,jdbcType=TIMESTAMP}, 
      #{rcProgress,jdbcType=NVARCHAR}, #{checkfileUrl,jdbcType=NVARCHAR}, #{rcString,jdbcType=NVARCHAR}, 
      #{rcRemark,jdbcType=NVARCHAR}, #{registerId,jdbcType=INTEGER}, #{prjId,jdbcType=INTEGER}, 
      #{checkdetails,jdbcType=NVARCHAR}, #{userId,jdbcType=CHAR}, #{photograph,jdbcType=NVARCHAR}, 
      #{autograph,jdbcType=NVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.fh.entity.amsmodel.Receive">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    insert into ams_receive
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="rcId != null">
        RC_ID,
      </if>
      <if test="transfname != null">
        TRANSFNAME,
      </if>
      <if test="prodepart != null">
        PRODEPART,
      </if>
      <if test="rcName != null">
        RC_NAME,
      </if>
      <if test="rcDepart != null">
        RC_DEPART,
      </if>
      <if test="rcTime != null">
        RC_TIME,
      </if>
      <if test="rcProgress != null">
        RC_PROGRESS,
      </if>
      <if test="checkfileUrl != null">
        CHECKFILE_URL,
      </if>
      <if test="rcString != null">
        RC_STRING,
      </if>
      <if test="rcRemark != null">
        RC_REMARK,
      </if>
      <if test="registerId != null">
        REGISTER_ID,
      </if>
      <if test="prjId != null">
        PRJ_ID,
      </if>
      <if test="checkdetails != null">
        CHECKDETAILS,
      </if>
      <if test="userId != null">
        USER_ID,
      </if>
      <if test="photograph != null">
        PHOTOGRAPH,
      </if>
      <if test="autograph != null">
        AUTOGRAPH,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="rcId != null">
        #{rcId,jdbcType=INTEGER},
      </if>
      <if test="transfname != null">
        #{transfname,jdbcType=NVARCHAR},
      </if>
      <if test="prodepart != null">
        #{prodepart,jdbcType=NVARCHAR},
      </if>
      <if test="rcName != null">
        #{rcName,jdbcType=NVARCHAR},
      </if>
      <if test="rcDepart != null">
        #{rcDepart,jdbcType=NVARCHAR},
      </if>
      <if test="rcTime != null">
        #{rcTime,jdbcType=TIMESTAMP},
      </if>
      <if test="rcProgress != null">
        #{rcProgress,jdbcType=NVARCHAR},
      </if>
      <if test="checkfileUrl != null">
        #{checkfileUrl,jdbcType=NVARCHAR},
      </if>
      <if test="rcString != null">
        #{rcString,jdbcType=NVARCHAR},
      </if>
      <if test="rcRemark != null">
        #{rcRemark,jdbcType=NVARCHAR},
      </if>
      <if test="registerId != null">
        #{registerId,jdbcType=INTEGER},
      </if>
      <if test="prjId != null">
        #{prjId,jdbcType=INTEGER},
      </if>
      <if test="checkdetails != null">
        #{checkdetails,jdbcType=NVARCHAR},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=CHAR},
      </if>
      <if test="photograph != null">
        #{photograph,jdbcType=NVARCHAR},
      </if>
      <if test="autograph != null">
        #{autograph,jdbcType=NVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.fh.entity.amsmodel.Receive">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    update ams_receive
    <set>
      <if test="transfname != null">
        TRANSFNAME = #{transfname,jdbcType=NVARCHAR},
      </if>
      <if test="prodepart != null">
        PRODEPART = #{prodepart,jdbcType=NVARCHAR},
      </if>
      <if test="rcName != null">
        RC_NAME = #{rcName,jdbcType=NVARCHAR},
      </if>
      <if test="rcDepart != null">
        RC_DEPART = #{rcDepart,jdbcType=NVARCHAR},
      </if>
      <if test="rcTime != null">
        RC_TIME = #{rcTime,jdbcType=TIMESTAMP},
      </if>
      <if test="rcProgress != null">
        RC_PROGRESS = #{rcProgress,jdbcType=NVARCHAR},
      </if>
      <if test="checkfileUrl != null">
        CHECKFILE_URL = #{checkfileUrl,jdbcType=NVARCHAR},
      </if>
      <if test="rcString != null">
        RC_STRING = #{rcString,jdbcType=NVARCHAR},
      </if>
      <if test="rcRemark != null">
        RC_REMARK = #{rcRemark,jdbcType=NVARCHAR},
      </if>
      <if test="registerId != null">
        REGISTER_ID = #{registerId,jdbcType=INTEGER},
      </if>
      <if test="prjId != null">
        PRJ_ID = #{prjId,jdbcType=INTEGER},
      </if>
      <if test="checkdetails != null">
        CHECKDETAILS = #{checkdetails,jdbcType=NVARCHAR},
      </if>
      <if test="userId != null">
        USER_ID = #{userId,jdbcType=CHAR},
      </if>
      <if test="photograph != null">
        PHOTOGRAPH = #{photograph,jdbcType=NVARCHAR},
      </if>
      <if test="autograph != null">
        AUTOGRAPH = #{autograph,jdbcType=NVARCHAR},
      </if>
    </set>
    where RC_ID = #{rcId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.fh.entity.amsmodel.Receive">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 15 11:18:22 CST 2016.
    -->
    update ams_receive
    set TRANSFNAME = #{transfname,jdbcType=NVARCHAR},
      PRODEPART = #{prodepart,jdbcType=NVARCHAR},
      RC_NAME = #{rcName,jdbcType=NVARCHAR},
      RC_DEPART = #{rcDepart,jdbcType=NVARCHAR},
      RC_TIME = #{rcTime,jdbcType=TIMESTAMP},
      RC_PROGRESS = #{rcProgress,jdbcType=NVARCHAR},
      CHECKFILE_URL = #{checkfileUrl,jdbcType=NVARCHAR},
      RC_STRING = #{rcString,jdbcType=NVARCHAR},
      RC_REMARK = #{rcRemark,jdbcType=NVARCHAR},
      REGISTER_ID = #{registerId,jdbcType=INTEGER},
      PRJ_ID = #{prjId,jdbcType=INTEGER},
      CHECKDETAILS = #{checkdetails,jdbcType=NVARCHAR},
      USER_ID = #{userId,jdbcType=CHAR},
      PHOTOGRAPH = #{photograph,jdbcType=NVARCHAR},
      AUTOGRAPH = #{autograph,jdbcType=NVARCHAR}
    where RC_ID = #{rcId,jdbcType=INTEGER}
  </update>


	<!-- 2016年6月15日23:20:34 kioor -->

	<sql id="tableName">
		ams_receive
	</sql>

	<!-- 列表 -->
	<select id="datalistPage" parameterType="page" resultType="pd">
		select
		<include refid="Base_Column_List" />
		from
		<include refid="tableName" />
		where 1=1
		<if test="pd.keywords!= null and pd.keywords != ''"><!-- 关键词检索 -->
			and
			(
			RC_ID LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			TRANSFNAME
			LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			PRODEPART LIKE
			CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			RC_NAME LIKE
			CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			RC_TIME LIKE
			CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			RC_REMARK LIKE
			CONCAT(CONCAT('%', #{pd.keywords}),'%')
			or
			PRJ_ID LIKE
			CONCAT(CONCAT('%', #{pd.keywords}),'%')
			)
		</if>
	</select>
	<insert id="save" keyProperty="rcId" parameterType="Receive" useGeneratedKeys="true">
		insert into
		<include refid="tableName" />
		(
		<include refid="ValueTemp" />
		) values (
		<include refid="FieldValueTemp" />
		)

	</insert>
	<insert id="savewithgraph" keyProperty="rcId" parameterType="Receive" useGeneratedKeys="true">
		insert into
		ams_receive
		(
			TRANSFNAME,PRODEPART,RC_NAME,RC_DEPART,RC_TIME,RC_PROGRESS,
			RC_STRING,RC_REMARK,REGISTER_ID,PRJ_ID,CHECKDETAILS,USER_ID,PHOTOGRAPH,AUTOGRAPH
		) values (
			#{transfname},#{prodepart},#{rcName},#{rcDepart},#{rcTime},#{rcProgress},
			#{rcString},#{rcRemark},#{registerId},#{prjId},#{checkdetails},#{userId},#{photograph},#{autograph}
			
		)

	</insert>
	<!-- <sql id="ValueTemp"> TRANSFNAME, PRODEPART, RC_NAME, RC_DEPART, RC_TIME, 
		RC_PROGRESS, RC_STRING, RC_REMARK, REGISTER_ID, PRJ_ID, CHECKDETAILS </sql> 
		<sql id="FieldValueTemp"> #{TRANSFNAME}, #{PRODEPART}, #{RC_NAME}, #{RC_DEPART}, 
		#{RC_TIME}, #{RC_PROGRESS}, #{RC_STRING}, #{RC_REMARK}, #{REGISTER_ID}, #{PRJ_ID}, 
		#{CHECKDETAILS} </sql> -->
	<sql id="ValueTemp">

		TRANSFNAME,
		PRODEPART,
		RC_NAME,
		RC_DEPART,
		RC_TIME,
		RC_PROGRESS,

		RC_STRING,
		RC_REMARK,
		REGISTER_ID,
		PRJ_ID,
		CHECKDETAILS,
		USER_ID
	</sql>

	<sql id="FieldValueTemp">

		#{transfname},
		#{prodepart},
		#{rcName},
		#{rcDepart},
		#{rcTime},
		#{rcProgress},
		#{rcString},
		#{rcRemark},
		#{registerId},
		#{prjId},
		#{checkdetails},
		#{userId}
	</sql>
<sql id="ValueTempWithGraph">

		TRANSFNAME,PRODEPART,RC_NAME,RC_DEPART,RC_TIME,RC_PROGRESS,
		RC_STRING,RC_REMARK,REGISTER_ID,PRJ_ID,CHECKDETAILS,USER_ID,PHOTOGRAPH,AUTOGRAPH
	</sql>

	<sql id="FieldValueTempWithGraph">

		#{transfname},#{prodepart},#{rcName},#{rcDepart},#{rcTime},#{rcProgress},
		#{rcString},#{rcRemark},#{registerId},#{prjId},#{checkdetails},#{userId},#{photograph},#{autograph}
	</sql>

	<select id="getRecivebyPageDate" parameterType="pd" resultType="pd">

		select rc_time as rctime,rc_id as rcid,rc_name,prj_id as
		prjId,prodepart from ams_receive where prj_id=#{prjId} order by rc_id
		desc

	</select>

	<select id="getRcNameAndUserName" parameterType="java.lang.Integer" resultType="pd">
	
		select a.* ,ap.PRJ_NAME as prjname from  (
select ar.RC_ID as RCID,ar.TRANSFNAME,ar.RC_NAME as rcname,PRODEPART,ar.RC_DEPART as RCDEPART,su.NAME,su.dname,ar.RC_TIME as RCTIME, ar.PRJ_ID  as prjId,ar.RC_REMARK as RCREMARK from ams_receive ar
		left join (	select sua.*,oad.NAME as dname from sys_user sua left join oa_department oad on oad.DEPARTMENT_ID=sua.DEPARTMENT_ID) su on su.USER_ID=ar.USER_ID   where	RC_ID=#{rcId,jdbcType=INTEGER}
		) a left join ams_project ap on a.prjId=ap.PRJ_ID

	
	

	
	</select>



</mapper>